"use strict";!function(){var e=ax5.ui,t=ax5.util;e.addClass({className:"uploader",version:"${VERSION}"},function(){var i=function(){var i;this.instanceId=ax5.getGuid(),this.config={clickEventName:"click",theme:"default",file_types:"*/*"},this.queue=[],this.target=null,this.selectedFile=null,this.uploadedFile=null,i=this.config,this.init=function(){this.target=$(i.target),function(){return!1}.call(this)},this.__request_select_file=function(){return!(i.before_select_file&&!i.before_select_file.call())&&void(window.imagePicker?window.imagePicker.getPictures(function(e){for(var t=0;t<e.length;t++)console.log("Image URI: "+e[t]);_this.__on_select_file(e)},function(e){console.log("Error: "+e)}):this.els["input-file"].trigger("click"))},this.__old_select_file=function(e){var t,s=this.target.id,n=this.els["preview-img"].get(0);if("dataTransfer"in e?t=e.dataTransfer.files[0]:"target"in e?t=e.target.files[0]:e&&(t=e[0]),!t)return!1;if(this.selected_file=t,function(e){function i(t,i,s){var n={},r=new Image;r.src=t.src,r.onload=function(){this.width>this.height?this.height>s?(n={width:this.width*(s/this.height),height:s},n.left=(i-n.width)/2):(n={width:this.width,height:this.height},n.top=(s-n.height)/2):this.width>i?(n={height:this.height*(i/this.width),width:i},n.top=(s-n.height)/2):(n={width:this.width,height:this.height},n.left=(i-n.width)/2),console.log(n),e.els["preview-img"].css(n)}}if(e.els["preview-img"].css({display:"block"}),window.imagePicker)n.src=t,i(n,e.els.container.width(),e.els.container.height());else{var r=new FileReader(s);r.onloadend=function(){try{n.src=r.result,i(n,e.els.container.width(),e.els.container.height())}catch(t){console.log(t)}},t&&r.readAsDataURL(t)}}(this),i.on_event){var r={action:"fileselect",file:t};i.on_event.call(r,r)}},this.__old_upload=function(){var e=this;if(!this.selected_file){if(i.on_event){var s={action:"error",error:ax5.info.get_error("single-uploader","460","upload")};i.on_event.call(s,s)}return this}var n=new FormData,r=this.els["progress-bar"];this.els.progress.css({display:"block"}),r.css({width:"0%"}),window.imagePicker?n.append(i.upload_http.filename_param_key,this.selected_file):n.append(i.upload_http.filename_param_key,this.selected_file);for(var l in i.upload_http.data)n.append(l,i.upload_http.data[l]);this.xhr=new XMLHttpRequest,this.xhr.open(i.upload_http.method,i.upload_http.url,!0),this.xhr.onload=function(i){var s=i.target.response;try{"string"==typeof s&&(s=t.parseJson(s))}catch(i){return console.log(i),!1}return s.error?(console.log(s.error),!1):void e.upload_complete(s)},this.xhr.upload.onprogress=function(i){r.css({width:t.number(i.loaded/i.total*100,{round:2})+"%"}),i.lengthComputable&&i.loaded>=i.total&&setTimeout(function(){e.els.progress.css({display:"none"})},300)},this.xhr.send(n)},this.main=function(){e.uploader_instance=e.uploader_instance||[],e.uploader_instance.push(this),arguments&&t.isObject(arguments[0])&&this.setConfig(arguments[0])}.apply(this,arguments)};return i}())}(),function(){var e=ax5.ui.uploader,t=function(e){return"\n        "};e.tmpl={uploadProgress:t,get:function(e,t,i){return ax5.mustache.render(TOAST.tmpl[e].call(this,i),t)}}}();
//# sourceMappingURL=ax5uploader.min.js.map
